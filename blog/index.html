<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<title>Cody Roberts</title>
<link href="../assets/stylesheets/application.css" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Radley:400,400italic" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic" rel="stylesheet" />
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" />
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />
</head>
<body class='type-system-traditional'>
<div class='blog-wrapper'>
<nav>
<ul class='nav-left'>
<li class='menu-item'>
<span id='namesake'>Cody Roberts</span>
</li>
</ul>
<ul class='nav-right'>
<li>
<span class='menu-item'>
<a href="/blog">blog</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/about">about</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/projects">projects</a>
</span>
</li>
<li id='hamburger'>
<span class='menu-item'>
<i class='fa fa-bars'></i>
</span>
</li>
</ul>
</nav>

<div class='post-archive'>
<p class='type'>Articles</p>
<div class='post-archive-item'>
<a href="/blog/article/chowmonger/">Chowmonger (Phoenix & Ember)</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/ember-data-in-components/">Ember Data & Components</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/streams-vs-enums/">Streams, Enums, and Protocols!</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/a-tour-of-phoenix/">A Tour of Phoenix</a>
</div>
<br>
<p class='type'>Today I Learned</p>
<div class='post-archive-item'>
<a href="/blog/til/iex-test-helper/">IEx Test Helper</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/Hex-Dependencies-Via-Vimscript/">Hex Dependencies via Vimscript</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/TDD-with-Elixir-and-Neovim/">TDD with Elixir and Neovim</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/comprehensions/">Elixir Comprehensions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/gen-server/">What is GenServer?</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/elixir-structs/">Elixir Structs</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/atoms/">Elixir Atoms</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/squashing-commits/">Squashing Commits</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/the-reverse-splat/">Ruby's Reverse Splat</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/railroady-uml-diagrams/">Railroady</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/embedding-in-ruby/">Embedding C & Rust in Ruby</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/using-gits-interactive-staging/">Git Interactive</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/select-random-rails-record/">ActiveRecord Random</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/manage-multiple-tmux-sessions/">Tmux Sessions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/focused-splits/">Focused Splits</a>
</div>

</div>
<div class='post-wrapper'>
<div class='post-header'>
<p class='date'>Dec 15, 2016</p>
<h2>IEx Test Helper</h2>
<hr>
</div>
<div class='post-content'>
<p>This week at <a href="https://www.meetup.com/ChicagoElixir/">Chicago Elixir</a> we were paring on some <a href="http://exercism.io/languages/elixir/about">Exercism</a>. <a href="https://twitter.com/dorian_escplan">Dorian Karter</a> was looking for a way to run ExUnit tests inside of IEx without mix.  Surely there must be a way! After some research I came up with this nugget.</p>

<pre class="highlight elixir"><code><span class="c1">#.iex.exs</span>
<span class="k">defmodule</span> <span class="no">TestHelper</span> <span class="k">do</span>
  <span class="nv">@moduledoc</span> <span class="no">false</span>

  <span class="nv">@doc</span><span class="sd">"""
  Reloads files and runs ExUnit tests in the pwd
  """</span>
  <span class="k">def</span> <span class="n">run_tests</span><span class="p">(</span><span class="n">opts</span> <span class="p">\\</span> <span class="p">[])</span> <span class="k">do</span>
    <span class="n">respawn</span>

    <span class="n">clear?</span> <span class="o">=</span> <span class="no">Keyword</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="ss">:clear</span><span class="p">,</span> <span class="no">false</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clear?</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="n">clear</span>

    <span class="no">Code</span><span class="o">.</span><span class="n">compiler_options</span><span class="p">(</span><span class="ss">ignore_module_conflict:</span> <span class="no">true</span><span class="p">)</span>
    <span class="no">Path</span><span class="o">.</span><span class="n">wildcard</span><span class="p">(</span><span class="sd">"</span><span class="s2">*_test.exs"</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span> <span class="no">Code</span><span class="o">.</span><span class="n">load_file</span> <span class="nv">&amp;1</span><span class="p">)</span>

    <span class="no">ExUnit</span><span class="o">.</span><span class="no">Server</span><span class="o">.</span><span class="n">cases_loaded</span>
    <span class="no">ExUnit</span><span class="o">.</span><span class="n">run</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>This assumes that the <code>*_test.exs</code> files in the pwd load the required modules first. Just plop this file in the pwd or in your home directory to obtain access to it in IEx.  Happy testing!</p>

</div>
<div class='post-comment'>
<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'bloomytil';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

</div>
</div>
</div>

<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="../assets/javascripts/application.js"></script>
</body>
</html>
