<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<title>TDD with Elixir and Neovim</title>
<link href="../../../assets/stylesheets/application.css" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Radley:400,400italic" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic" rel="stylesheet" />
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" />
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />
</head>
<body class='type-system-traditional'>
<div class='blog-wrapper'>
<nav>
<ul class='nav-left'>
<li class='menu-item'>
<span id='namesake'>Cody Roberts</span>
</li>
</ul>
<ul class='nav-right'>
<li>
<span class='menu-item'>
<a href="/blog">blog</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/about">about</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/projects">projects</a>
</span>
</li>
<li id='hamburger'>
<span class='menu-item'>
<i class='fa fa-bars'></i>
</span>
</li>
</ul>
</nav>

<div class='post-archive'>
<p class='type'>Articles</p>
<div class='post-archive-item'>
<a href="/blog/article/chowmonger/">Chowmonger (Phoenix & Ember)</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/ember-data-in-components/">Ember Data & Components</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/streams-vs-enums/">Streams, Enums, and Protocols!</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/a-tour-of-phoenix/">A Tour of Phoenix</a>
</div>
<br>
<p class='type'>Today I Learned</p>
<div class='post-archive-item'>
<a href="/blog/til/iex-test-helper/">IEx Test Helper</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/Hex-Dependencies-Via-Vimscript/">Hex Dependencies via Vimscript</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/TDD-with-Elixir-and-Neovim/">TDD with Elixir and Neovim</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/comprehensions/">Elixir Comprehensions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/gen-server/">What is GenServer?</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/elixir-structs/">Elixir Structs</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/atoms/">Elixir Atoms</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/squashing-commits/">Squashing Commits</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/the-reverse-splat/">Ruby's Reverse Splat</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/railroady-uml-diagrams/">Railroady</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/embedding-in-ruby/">Embedding C & Rust in Ruby</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/using-gits-interactive-staging/">Git Interactive</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/select-random-rails-record/">ActiveRecord Random</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/manage-multiple-tmux-sessions/">Tmux Sessions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/focused-splits/">Focused Splits</a>
</div>

</div>
<div class='post-wrapper'>
<div class='post-header'>
<p class='date'>Jul 8, 2016</p>
<h2>TDD with Elixir and Neovim</h2>
<hr>
</div>
<div class='post-content'>
<p>I had pretty good mileage with <a href="https://github.com/lpil/mix-test.watch">mix-test.watch</a>, but recently it hasn't been working for me. There also seems to be some issues using it with Phoenix. I searched for another test runner but couldn't seem to find one.</p>

<p>In an effort to make use of Neovim's terminal editor and solve my testing problem, I decided to ditch my typical tmux workflow. I wrote up a simple vim binding to run my tests in a :vsplit window.</p>

<pre class="highlight viml"><code>nnoremap <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">r</span> <span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">l</span><span class="p">&lt;</span>Insert<span class="p">&gt;</span>clear<span class="p">&lt;</span>CR<span class="p">&gt;</span>mix test<span class="p">&lt;</span>CR<span class="p">&gt;&lt;</span>C<span class="p">-</span>\<span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">n</span><span class="p">&gt;&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">h</span>
</code></pre>

<p>This will bind the leader key + 'r' to switch to the right split, clear the screen, run mix test, and return to the left split.</p>

<p>This isn't ideal and could use a bit of improvement, but it's good to switch things up occasionally.</p>

<p><strong>UPDATE</strong>: I switched it up and now resort to opening a new vsplit for tests</p>

<pre class="highlight viml"><code>nnoremap <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">r</span> <span class="p">:</span><span class="k">vsplit</span><span class="p">&lt;</span>CR<span class="p">&gt;:</span>term mix test<span class="p">&lt;</span>CR<span class="p">&gt;</span>
</code></pre>

<p><strong>UPDATE #2</strong>: I pity the fool</p>

<p><a href="https://github.com/ruby2elixir/mr_t">MrT</a> works wonderfully for keeping that feedback loop tight. The structure is a bit rigid at the moment. It currently will not run tests for a module unless the file names match, e.g. <code>something.ex</code> and <code>something_test.exs</code>. I keep it running and still fire off single tests using <a href="https://github.com/kassio/neoterm">neoterm</a>.</p>

</div>
<div class='post-comment'>
<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'bloomytil';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

</div>

</div>
</div>
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="../../../assets/javascripts/application.js"></script>
</body>
</html>
