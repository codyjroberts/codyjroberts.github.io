<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<title>Elixir Structs</title>
<link href="../../../assets/stylesheets/application.css" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Radley:400,400italic" rel="stylesheet" />
<link href="//fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic" rel="stylesheet" />
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" />
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />
</head>
<body class='type-system-traditional'>
<div class='blog-wrapper'>
<nav>
<ul class='nav-left'>
<li class='menu-item'>
<span id='namesake'>Cody Roberts</span>
</li>
</ul>
<ul class='nav-right'>
<li>
<span class='menu-item'>
<a href="/blog">blog</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/about">about</a>
</span>
</li>
<li>
<span class='menu-item'>
<a href="/projects">projects</a>
</span>
</li>
<li id='hamburger'>
<span class='menu-item'>
<i class='fa fa-bars'></i>
</span>
</li>
</ul>
</nav>

<div class='post-archive'>
<p class='type'>Articles</p>
<div class='post-archive-item'>
<a href="/blog/article/chowmonger/">Chowmonger (Phoenix & Ember)</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/ember-data-in-components/">Ember Data & Components</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/streams-vs-enums/">Streams, Enums, and Protocols!</a>
</div>
<div class='post-archive-item'>
<a href="/blog/article/a-tour-of-phoenix/">A Tour of Phoenix</a>
</div>
<br>
<p class='type'>Today I Learned</p>
<div class='post-archive-item'>
<a href="/blog/til/iex-test-helper/">IEx Test Helper</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/Hex-Dependencies-Via-Vimscript/">Hex Dependencies via Vimscript</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/TDD-with-Elixir-and-Neovim/">TDD with Elixir and Neovim</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/comprehensions/">Elixir Comprehensions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/gen-server/">What is GenServer?</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/elixir-structs/">Elixir Structs</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/atoms/">Elixir Atoms</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/squashing-commits/">Squashing Commits</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/the-reverse-splat/">Ruby's Reverse Splat</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/railroady-uml-diagrams/">Railroady</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/embedding-in-ruby/">Embedding C & Rust in Ruby</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/using-gits-interactive-staging/">Git Interactive</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/select-random-rails-record/">ActiveRecord Random</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/manage-multiple-tmux-sessions/">Tmux Sessions</a>
</div>
<div class='post-archive-item'>
<a href="/blog/til/focused-splits/">Focused Splits</a>
</div>

</div>
<div class='post-wrapper'>
<div class='post-header'>
<p class='date'>Feb 8, 2016</p>
<h2>Elixir Structs</h2>
<hr>
</div>
<div class='post-content'>
<p>Elixir structs are built on top of Maps, a key/value pair data structure.
Structs provide helpful features such as default values and compile time errors.</p>

<p>Structs are usually defined using the defstruct/1 inside of a module.</p>

<pre class="highlight elixir"><code><span class="k">defmodule</span> <span class="no">Kitty</span> <span class="k">do</span>
  <span class="n">defstruct</span> <span class="ss">name:</span> <span class="no">nil</span><span class="p">,</span> <span class="ss">age:</span> <span class="no">nil</span><span class="p">,</span> <span class="ss">breed:</span> <span class="no">nil</span>
  <span class="c1">#defstruct [:name, :age, :breed]</span>
<span class="k">end</span>
</code></pre>

<p>defstruct/1 takes a key/value list where the values are the defaults. If you
happen to be defaulting to nil for every field, you can use the alternative
syntax on the second line that only provides the keys.</p>

<p>You can access a struct in the same way as a Map, except it's defined by its
module name:</p>

<pre class="highlight elixir"><code><span class="n">iex</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">meow</span> <span class="o">=</span> <span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">"</span><span class="s2">Floyd"</span><span class="p">}</span>
<span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="ss">age:</span> <span class="no">nil</span><span class="p">,</span> <span class="ss">breed:</span> <span class="no">nil</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">"</span><span class="s2">Floyd"</span><span class="p">}</span>
<span class="n">iex</span><span class="p">(</span><span class="m">4</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">meow</span> <span class="o">=</span> <span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="n">meow</span> <span class="o">|</span> <span class="ss">age:</span> <span class="m">2</span><span class="p">}</span>
<span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="ss">age:</span> <span class="m">2</span><span class="p">,</span> <span class="ss">breed:</span> <span class="no">nil</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">"</span><span class="s2">Floyd"</span><span class="p">}</span>
<span class="n">iex</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="n">meow</span> <span class="o">|</span> <span class="ss">color:</span> <span class="sd">"</span><span class="s2">white"</span><span class="p">}</span>
<span class="o">**</span> <span class="p">(</span><span class="no">CompileError</span><span class="p">)</span> <span class="ss">iex:</span><span class="m">5</span><span class="p">:</span> <span class="n">unknown</span> <span class="n">key</span> <span class="ss">:color</span> <span class="n">for</span> <span class="n">struct</span> <span class="no">Kitty</span>
    <span class="p">(</span><span class="n">elixir</span><span class="p">)</span> <span class="n">src</span><span class="o">/</span><span class="n">elixir_map</span><span class="o">.</span><span class="ss">erl:</span><span class="m">185</span><span class="p">:</span> <span class="ss">:elixir_map</span><span class="o">.</span><span class="sd">"</span><span class="s2">-assert_struct_keys/5-lc$^0/1-0-"</span><span class="o">/</span><span class="m">5</span>
    <span class="p">(</span><span class="n">elixir</span><span class="p">)</span> <span class="n">src</span><span class="o">/</span><span class="n">elixir_map</span><span class="o">.</span><span class="ss">erl:</span><span class="m">62</span><span class="p">:</span> <span class="ss">:elixir_map</span><span class="o">.</span><span class="n">translate_struct</span><span class="o">/</span><span class="m">4</span>
<span class="n">iex</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre>

<p>As you can see, structs only allow entry of defined keys.</p>

<p>You can also provide a typespec.</p>

<pre class="highlight elixir"><code><span class="k">defmodule</span> <span class="no">Kitty</span> <span class="k">do</span>
  <span class="n">defstruct</span> <span class="p">[</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:age</span><span class="p">,</span> <span class="ss">:breed</span><span class="p">]</span>

  <span class="nv">@type</span> <span class="n">t</span> <span class="p">::</span> <span class="p">%</span><span class="no">Kitty</span><span class="p">{</span><span class="ss">name:</span> <span class="no">String</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="ss">age:</span> <span class="n">non_neg_integer</span><span class="p">,</span> <span class="ss">breed:</span> <span class="no">String</span><span class="o">.</span><span class="n">t</span><span class="p">}</span>
<span class="k">end</span>
</code></pre>

</div>
<div class='post-comment'>
<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'bloomytil';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

</div>

</div>
</div>
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="../../../assets/javascripts/application.js"></script>
</body>
</html>
